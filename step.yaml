kind: step-type
version: '1.0'
metadata:
  name: brandonphillips/bump-build-number
  version: 0.2.0
  isPublic: false
  description: Bump the build number
  # Should be updated to https://github.com/codefresh-io/steps/tree/master/incubating/bump-build-number
  sources:
    - >-
      https://github.com/brandonphillips/bump-build-number
  stage: incubating
  maintainers:
    - name: Brandon Phillips
  categories:
    - build
  official: false
  tags: []
  icon:
    type: image
    # Should be updated to https://raw.githubusercontent.com/codefresh-plugins/bump-build-number/master/icon.png
    url: https://raw.githubusercontent.com/brandonphillips/bump-build-number/master/icon.png
    background: "#f4f4f4"
    size:
      large:
        url: >-
          https://raw.githubusercontent.com/brandonphillips/bump-build-number/master/icon.png
  examples:
    - description: Default Annotation
      workflow:  
        BumpBuildNumber:
          title: Bump default build_number annotation
          type: bump-build-number
    - description: Custom Annotation
      workflow:
        BumpBuildNumber:
          title: Bump custom annotation name
          type: bump-build-number
          arguments:
            ANNOTATION_NAME: ${{CF_BRANCH}}_build_number
spec:
  arguments: |-
    {
        "definitions": {},
        "$schema": "http://json-schema.org/draft-07/schema#",
        "type": "object",
        "additionalProperties": false,
        "patterns": [],
        "required": [],
        "properties": {
            "ANNOTATION_NAME": {
                "type": "string",
                "description": "Override the build_number annotation name"
            }
        }
    }
  steps:
    main:
      name: bump-build-number
      # Needs to change to codefresh repo for final code delivery
      image: fleatbnp/bump-build-number:v0.2.0
      environment:
        - 'ANNOTATION_NAME=${{ANNOTATION_NAME}}'